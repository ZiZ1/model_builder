# coding=utf-8
""" Holding properties of residues"""

import numpy as np

"""Masses in atomic mass units"""
residue_mass = {'ALA':   89.0935, 'ARG':  174.2017, 'ASN':  132.1184,
                'ASP':  133.1032, 'CYS':  121.1590, 'GLN':  146.1451,
                'GLU':  147.1299, 'GLY':   75.0669, 'HIS':  155.1552,
                'ILE':  131.1736, 'LEU':  131.1736, 'LYS':  146.1882,
                'MET':  149.2124, 'PHE':  165.1900, 'PRO':  115.1310,
                'SER':  105.0930, 'THR':  119.1197, 'TRP':  204.2262,
                'TYR':  181.1894, 'VAL':  117.1469, 'SOL':   18.0150}

"""Converting from three letter code to one letter FASTA code."""
residue_code = {'ALA': 'A', 'ARG': 'R', 'ASN': 'N',
                'ASP': 'D', 'CYS': 'C', 'GLN': 'Q',
                'GLU': 'E', 'GLY': 'G', 'HIS': 'H',
                'ILE': 'I', 'LEU': 'L', 'LYS': 'K',
                'MET': 'M', 'PHE': 'F', 'PRO': 'P',
                'SER': 'S', 'THR': 'T', 'TRP': 'W',
                'TYR': 'Y', 'VAL': 'V'}

"""Source: Partial molar volumes of proteins: amino acid side-chain
contributions derived from the partial molar volumes of some tripeptide
Atomic radii in nanometers"""
residue_radii = {'ALA': 0.1844827, 'ARG': 0.3134491, 'ASN': 0.2477519,
                'ASP': 0.2334602, 'CYS': 0.2276212, 'GLN': 0.2733978,
                'GLU': 0.2639170, 'GLY': 0.0000000, 'HIS': 0.2835556,
                'ILE': 0.2889931, 'LEU': 0.2887070, 'LYS': 0.2937731,
                'MET': 0.2916368, 'PHE': 0.3140150, 'PRO': 0.2419109,
                'SER': 0.1936102, 'THR': 0.2376198, 'TRP': 0.3422321,
                'TYR': 0.3168939, 'VAL': 0.2619603, 'AVERAGE': 0.2683678}

residues_alpha = ['ALA', 'ARG', 'ASN', 'ASP', 'CYS', 'GLN',
                  'GLU', 'GLY', 'HIS', 'ILE', 'LEU', 'LYS',
                  'MET', 'PHE', 'PRO', 'SER', 'THR', 'TRP',
                  'TYR', 'VAL']

awsem_direct_contact_gammas = np.array([
[  0.720080, -0.270290,  -0.259680,  -0.402220,   0.620530,  -0.244690,  -0.348510,  -0.113910,  -0.125110,   1.000000,   1.000000,  -0.451560,   0.507320,   0.568570,  -0.534590,  -0.206250,   0.080040,   0.396630,   0.111830,   0.917950],
[ -0.270290, -0.641720,  -0.281130,   0.409220,  -0.400380,  -0.209180,  -0.033780,  -0.328640,  -0.534140,  -0.136290,  -0.251040,  -0.955880,  -0.016960,  -0.175140,  -0.824930,  -0.331090,  -0.234460,  -0.299730,   0.140870,  -0.169600],
[ -0.259680, -0.281130,   0.164030,   0.024840,  -0.092170,  -0.193760,  -0.562360,  -0.144930,  -0.069100,  -0.724360,  -0.578350,  -0.454760,  -0.595000,  -0.522340,  -0.694000,  -0.021710,  -0.314120,  -0.373100,  -0.274600,  -0.591150],
[ -0.402220,  0.409220,   0.024840,  -0.572840,  -0.369600,  -0.393600,  -0.847440,  -0.304370,  -0.084570,  -0.721130,  -0.782620,   0.105590,  -0.578660,  -0.762530,  -0.816750,  -0.034430,  -0.219790,  -0.739460,  -0.781870,  -0.736310],
[  0.620530, -0.400380,  -0.092170,  -0.369600,   0.977650,  -0.434360,  -0.357920,   0.433920,   0.694100,   0.702920,   0.977650,  -0.575230,   0.297840,   0.851080,   0.085830,   0.471820,  -0.175140,   0.100470,   0.865350,   0.950440],
[ -0.244690, -0.209180,  -0.193760,  -0.393600,  -0.434360,  -0.287070,  -0.491660,  -0.369150,  -0.717500,  -0.431820,  -0.294620,  -0.491360,  -0.332390,  -0.345180,  -0.596080,  -0.341940,  -0.032120,  -0.556030,  -0.205660,  -0.275010],
[ -0.348510, -0.033780,  -0.562360,  -0.847440,  -0.357920,  -0.491660,  -0.857940,  -0.548380,  -0.503420,  -0.493860,  -0.556730,   0.130180,  -0.768200,  -0.749760,  -0.777100,  -0.307940,   0.047860,  -0.459950,  -0.315650,  -0.381750],
[ -0.113910, -0.328640,  -0.144930,  -0.304370,   0.433920,  -0.369150,  -0.548380,   0.370360,  -0.423550,   0.037100,  -0.219210,  -0.482800,   0.133610,  -0.052230,  -0.415650,   0.023300,  -0.138350,   0.038610,   0.149100,  -0.113070],
[ -0.125110, -0.534140,  -0.069100,  -0.084570,   0.694100,  -0.717500,  -0.503420,  -0.423550,  -0.158360,  -0.295070,   0.082500,  -0.553100,   0.196090,   0.368320,  -0.603340,  -0.028730,  -0.092810,  -0.012180,   0.260840,   0.155480],
[  1.000000, -0.136290,  -0.724360,  -0.721130,   0.702920,  -0.431820,  -0.493860,   0.037100,  -0.295070,   0.977650,   0.977650,  -0.710050,   0.744110,   0.877760,  -0.430510,  -0.431150,  -0.024320,   0.819440,   0.896230,   0.977650],
[  1.000000, -0.251040,  -0.578350,  -0.782620,   0.977650,  -0.294620,  -0.556730,  -0.219210,   0.082500,   0.977650,   0.977650,  -0.662470,   0.852470,   0.792690,  -0.543030,  -0.341180,   0.010570,   0.977650,   0.693170,   0.977650],
[ -0.451560, -0.955880,  -0.454760,   0.105590,  -0.575230,  -0.491360,   0.130180,  -0.482800,  -0.553100,  -0.710050,  -0.662470,  -0.967900,  -0.704820,  -0.663430,  -1.000000,  -0.621540,  -0.547860,  -0.397950,  -0.180360,  -0.618030],
[  0.507320, -0.016960,  -0.595000,  -0.578660,   0.297840,  -0.332390,  -0.768200,   0.133610,   0.196090,   0.744110,   0.852470,  -0.704820,   0.517480,   0.688710,  -0.496770,  -0.334410,  -0.093070,   0.116720,   0.635000,   0.628080],
[  0.568570, -0.175140,  -0.522340,  -0.762530,   0.851080,  -0.345180,  -0.749760,  -0.052230,   0.368320,   0.877760,   0.792690,  -0.663430,   0.688710,   0.977650,  -0.217920,  -0.267220,  -0.155050,   0.669960,   0.615280,   0.783650],
[ -0.534590, -0.824930,  -0.694000,  -0.816750,   0.085830,  -0.596080,  -0.777100,  -0.415650,  -0.603340,  -0.430510,  -0.543030,  -1.000000,  -0.496770,  -0.217920,  -0.507190,  -0.561690,  -0.470210,   0.011610,   0.058920,  -0.327550],
[ -0.206250, -0.331090,  -0.021710,  -0.034430,   0.471820,  -0.341940,  -0.307940,   0.023300,  -0.028730,  -0.431150,  -0.341180,  -0.621540,  -0.334410,  -0.267220,  -0.561690,  -0.104390,  -0.095870,  -0.320550,  -0.299430,  -0.249360],
[  0.080040, -0.234460,  -0.314120,  -0.219790,  -0.175140,  -0.032120,   0.047860,  -0.138350,  -0.092810,  -0.024320,   0.010570,  -0.547860,  -0.093070,  -0.155050,  -0.470210,  -0.095870,   0.160540,  -0.437650,  -0.223700,   0.181280],
[  0.396630, -0.299730,  -0.373100,  -0.739460,   0.100470,  -0.556030,  -0.459950,   0.038610,  -0.012180,   0.819440,   0.977650,  -0.397950,   0.116720,   0.669960,   0.011610,  -0.320550,  -0.437650,   0.074860,   0.212180,   0.517340],
[  0.111830,  0.140870,  -0.274600,  -0.781870,   0.865350,  -0.205660,  -0.315650,   0.149100,   0.260840,   0.896230,   0.693170,  -0.180360,   0.635000,   0.615280,   0.058920,  -0.299430,  -0.223700,   0.212180,   0.545870,   0.617310],
[  0.917950, -0.169600,  -0.591150,  -0.736310,   0.950440,  -0.275010,  -0.381750,  -0.113070,   0.155480,   0.977650,   0.977650,  -0.618030,   0.628080,   0.783650,  -0.327550,  -0.249360,   0.181280,   0.517340,   0.617310,   0.977650]])

def get_awsem_direct_contact_gamma(resA,resB):
    """ Returns direct contact interactions strength from AWSEM

    From the supplementary information of: 
    Davtyan, A.; Schafer, N. P.; Zheng, W.; Clementi, C.; Peter, G.
    Supplemental - AWSEM-MD : Protein Structure Prediction Using Coarse-Grained
    Physical Potentials and Bioinformatically Based Local Structure Biasing
    Description of the Coarse-Grained Protein Chain. J. Phys. Chem. B 2012, 1â€“22.
    """
    idx_a = residues_alpha.index(resA)
    idx_b = residues_alpha.index(resB)
    return awsem_direct_contact_gammas[idx_a,idx_b]
